import fitz  # PyMuPDF

def extract_text_with_numbers(pdf_path, output_txt_path):
    # Open the PDF
    doc = fitz.open(pdf_path)
    all_text = []

    # Extract text from each page
    for page_num, page in enumerate(doc):
        text = page.get_text("text")
        lines = text.split('\n')
        
        # Replace "·" with space in each line
        processed_lines = [line.replace('·', ' ') for line in lines]
        
        # Combine the processed lines into a single string for length checking
        combined_text = "\n".join(processed_lines)
        
        if len(combined_text) > 150:  # Only process pages with text length greater than 150 characters
            all_text.append(f"Page {page_num + 1}")
            all_text.extend(processed_lines)
            all_text.append("")  # Add a space between pages for readability
            print(f"Processed page {page_num + 1} of size {len(combined_text)}")
        else:
            print(f"Skipped page {page_num + 1} of size {len(combined_text)}")

    # Write results to a text file
    with open(output_txt_path, 'w', encoding='utf-8') as f:
        for line in all_text:
            f.write(line + '\n')

# Provide the path to your PDF and the output text file path
extract_text_with_numbers("C:\\Users\\bobbu\\OneDrive\\Desktop\\Deposition Summarizer\\depo original pdfs\\AshrafElsayeghMD.pdf", "AshrafElsayeghMD final 2nd textfile.txt")

print("Processing completed. Data written to:", output_txt_path)
